<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  <meta name="description" content=""/>
  <meta name="author" content=""/>
  <title>King & Queen Voting</title>

  <!-- Bootstrap core CSS-->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <!-- Custom Style-->
  <link href="css/app-style.css" rel="stylesheet"/>
  <style>
    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      -webkit-transition: .4s;
      transition: .4s;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      -webkit-transition: .4s;
      transition: .4s;
    }

    input:checked + .slider {
      background-color: #2196F3;
    }

    input:focus + .slider {
      box-shadow: 0 0 1px #2196F3;
    }

    input:checked + .slider:before {
      -webkit-transform: translateX(26px);
      -ms-transform: translateX(26px);
      transform: translateX(26px);
    }

    /* Rounded sliders */
    .slider.round {
      border-radius: 34px;
    }

    .slider.round:before {
      border-radius: 50%;
    }

  </style>
</head>

<body class="bg-theme bg-theme4">

<!-- Start wrapper-->
<div id="wrapper">

  <div class="loader-wrapper">
    <div class="lds-ring">
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
  <div class="clearfix"></div>
  <div class="content-wrapper">
    <div class="container-fluid">
      <div id="body" class="row mt-3">
        <div class="col-lg-6">
          <div class="card">
            <div class="card-body">
              <div class="card-title">
                VOTE KING
              </div>
              <hr>
              <button type="button" class="btn btn-light px-5" style="width: 100%; height: 100px" onclick="window.location.href = '/vote-king'">
                Vote now
              </button>
            </div>
          </div>
        </div>

        <div class="col-lg-6">
          <div class="card">
            <div class="card-body">
              <div class="card-title">
                VOTE QUEEN
              </div>
              <hr>
              <button type="button" class="btn btn-light px-5" style="width: 100%; height: 100px" onclick="window.location.href = '/vote-queen'">
                Do it
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--Start Back To Top Button-->
  <a href="javaScript:void();" class="back-to-top"><i class="fa fa-angle-double-up"></i> </a>
  <!--End Back To Top Button-->

</div><!--wrapper-->

<!-- Bootstrap core JavaScript-->
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<!--<script src="js/bootstrap.min.js"></script>-->


<script>
  $(document).ready(function () {
    var isLoggedIn = localStorage.getItem('isLoggedIn');
    var pageCreate = '/create';
    var pageUpdate = '/list';
    var email = localStorage.getItem('email');

    initPage();

    if (isLoggedIn && parseInt(isLoggedIn)) {
      console.log('isLoggedIn');
      if(email === 'admin@gumiviet.com') {
        $('#body').append('<div class="col-lg-6">' +
          '          <div class="card">' +
          '          <div class="card-body">' +
          '          <div class="card-title">' +
          '          ADMIN' +
          '        </div>' +
          '        <hr>' +
          '        <button type="button" class="btn btn-light px-5" style="width: 100%; height: 100px" onclick="window.location.href=' +
          '\'' + pageCreate + '\'' + '">' +
          '          CREATE USER' +
          '        </button>' +
          '<hr>' +
          '        <button type="button" class="btn btn-light px-5" style="width: 100%; height: 100px" onclick="window.location.href=' +
          '\'' + pageUpdate + '\'' + '">' +
          '          UPDATE-DELETE' +
          '        </button>' +
          '<hr>' +
          '<div class="btn btn-light px-5" style="width: 100%; height: 100px">' +
          ' <p class="display-ui">START VOTE / STOP VOTE</p>' +
          ' <label class="switch">' +
          '  <input name="display_ui" type="checkbox" value="1" checked onclick="settingVote()">' +
          '  <span class="slider round"></span>' +
          ' </label>' +
          '</div> ' +
          '<hr>' +
          '        <button type="button" class="btn btn-light px-5" style="width: 100%; height: 100px" onclick="logout()">' +
          '          LOGOUT' +
          '        </button>' +
          '        </div>' +
          '        </div>' +
          '        </div>');
      } else {
        $('#body').append('<div class="col-lg-6">' +
          '          <div class="card">' +
          '          <div class="card-body">' +
          '          <div class="card-title">' +
          '          LOGOUT' +
          '        </div>' +
          '        <hr>' +
          '        <button type="button" class="btn btn-light px-5" style="width: 100%; height: 100px" onclick="logout()">' +
          '          LOGOUT' +
          '        </button>' +
          '        </div>' +
          '        </div>' +
          '        </div>');
      }
    } else {
      window.location.href = '/login';
    }

    function initPage () {
      $.ajax({
        type: 'GET',
        url: '/api/setting',
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        success: function (res) {
          if (res.setting === 1) {
            $('input[name="display_ui"]').prop('checked', true);
          } else {
            $('input[name="display_ui"]').prop('checked', false);
          }
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
          var error = XMLHttpRequest.responseJSON.error;
          alert(error);
        },
      });
    }
  });

  function logout () {
    localStorage.removeItem('id');
    localStorage.removeItem('email');
    localStorage.removeItem('isLoggedIn');
    window.location.href = '/login';
  }

  function settingVote () {
    var inputCheck = $('input[name="display_ui"]:checked').val();
    if(inputCheck) {
      if(confirm('Bạn có muốn MỞ chức năng VOTE không ?')) {
        $.ajax({
          type: 'POST',
          url: '/api/setting',
          contentType: 'application/json; charset=utf-8',
          dataType: 'json',
          data: JSON.stringify({
            setting: 1
          }),
          success: function (res) {
            window.location.reload();
          },
          error: function (XMLHttpRequest, textStatus, errorThrown) {
            var error = XMLHttpRequest.responseJSON.error;
            alert(error);
          },
        });
      } else {
        $('input[name="display_ui"]').prop('checked', false);
      }
    } else {
      if(confirm('Bạn có muốn TẮT chức năng VOTE không ?')) {
        $.ajax({
          type: 'POST',
          url: '/api/setting',
          contentType: 'application/json; charset=utf-8',
          dataType: 'json',
          data: JSON.stringify({
            setting: 0
          }),
          success: function (res) {
            window.location.reload();
          },
          error: function (XMLHttpRequest, textStatus, errorThrown) {
            var error = XMLHttpRequest.responseJSON.error;
            alert(error);
          },
        });
      }
      else {
        $('input[name="display_ui"]').prop('checked', true);
      }
    }

  }
</script>

</body>
</html>
